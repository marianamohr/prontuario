import{e as _,r as a,aj as B,j as e,B as u,T as r,L as x,P as q,V as M,ak as U}from"./index-DJlnvih6.js";import{i as m}from"./cpf-Bdeebvjv.js";import{T as l}from"./TextField-CttgYVuf.js";import{F as z,I as J,S as G}from"./Select-cu5oWY5i.js";import{B as H}from"./Button-6qkZ5rwi.js";const K=[{value:"",label:"Selecione"},{value:"SOLTEIRO",label:"Solteiro(a)"},{value:"CASADO",label:"Casado(a)"},{value:"DIVORCIADO",label:"Divorciado(a)"},{value:"VIUVO",label:"Viúvo(a)"},{value:"OUTRO",label:"Outro"}];function ee(){const[I]=_(),i=I.get("token")||"",[o,W]=a.useState(null),[L,h]=a.useState(!!i),[c,n]=a.useState(""),[p,f]=a.useState(""),[v,O]=a.useState(""),[b,A]=a.useState(""),[s,E]=a.useState(""),[g,F]=a.useState(""),[j,T]=a.useState(""),[d,k]=a.useState(""),[S,D]=a.useState(""),[C,y]=a.useState(!1),[N,w]=a.useState(!1);a.useEffect(()=>{if(!i){h(!1);return}B(i).then(t=>{W(t),f(t.full_name)}).catch(()=>n("Link inválido ou expirado.")).finally(()=>h(!1))},[i]);const R=async t=>{if(t.preventDefault(),n(""),d!==S){n("As senhas não coincidem.");return}if(!s.trim()){n("CPF é obrigatório.");return}if(!m(s)){n("CPF inválido.");return}if(d.length<8){n("A senha deve ter pelo menos 8 caracteres.");return}y(!0);try{await U({token:i,password:d,full_name:p||void 0,trade_name:v||void 0,birth_date:b||void 0,cpf:s||void 0,address:g||void 0,marital_status:j||void 0}),w(!0)}catch(P){const V=P instanceof Error?P.message:"Não foi possível concluir o cadastro.";n(V)}finally{y(!1)}};return i?L?e.jsx(u,{sx:{maxWidth:400,mx:"auto",p:2},children:e.jsx(r,{color:"text.secondary",children:"Carregando..."})}):c&&!o?e.jsxs(u,{sx:{maxWidth:400,mx:"auto",p:2,textAlign:"center"},children:[e.jsx(r,{variant:"h5",sx:{mb:.5},children:"Link inválido ou expirado"}),e.jsx(r,{children:c}),e.jsx(r,{sx:{mt:2},children:e.jsx(x,{to:"/login",style:{color:"inherit"},children:"Ir para o login"})})]}):N?e.jsxs(u,{sx:{maxWidth:400,mx:"auto",p:2,textAlign:"center"},children:[e.jsx(r,{variant:"h5",sx:{mb:.5},children:"Cadastro concluído"}),e.jsx(r,{children:"Faça login na área do profissional com seu e-mail e senha."}),e.jsx(r,{sx:{mt:2},children:e.jsx(x,{to:"/login",style:{fontWeight:600,color:"inherit"},children:"Ir para o login"})})]}):e.jsx(u,{sx:{maxWidth:480,mx:"auto",p:2},children:e.jsxs(q,{variant:"outlined",sx:{p:2},children:[e.jsx(r,{variant:"h5",sx:{mb:.5},children:"Concluir cadastro"}),e.jsxs(r,{color:"text.secondary",sx:{mb:2,fontSize:14},children:["Você foi convidado para ",o==null?void 0:o.clinic_name,". Preencha os dados abaixo."]}),e.jsxs(u,{component:"form",onSubmit:R,children:[e.jsx(l,{label:"E-mail",type:"email",fullWidth:!0,value:(o==null?void 0:o.email)??"",InputProps:{readOnly:!0},sx:{mb:1.5}}),e.jsx(l,{label:"Nome completo",fullWidth:!0,required:!0,value:p,onChange:t=>f(t.target.value),sx:{mb:1.5}}),e.jsx(l,{label:"Nome fantasia",fullWidth:!0,value:v,onChange:t=>O(t.target.value),sx:{mb:1.5}}),e.jsx(l,{type:"date",label:"Data de nascimento",fullWidth:!0,value:b,onChange:t=>A(t.target.value),InputLabelProps:{shrink:!0},sx:{mb:1.5}}),e.jsx(l,{label:"CPF",fullWidth:!0,required:!0,placeholder:"000.000.000-00",inputProps:{maxLength:14},value:s,onChange:t=>E(t.target.value),error:!!s.trim()&&!m(s),helperText:s.trim()&&!m(s)?"CPF inválido.":" ",sx:{mb:1.5}}),e.jsx(l,{label:"Endereço",fullWidth:!0,placeholder:"Rua, número, bairro, cidade, UF",value:g,onChange:t=>F(t.target.value),sx:{mb:1.5}}),e.jsxs(z,{fullWidth:!0,sx:{mb:1.5},children:[e.jsx(J,{children:"Estado civil"}),e.jsx(G,{value:j,label:"Estado civil",onChange:t=>T(t.target.value),children:K.map(t=>e.jsx(M,{value:t.value,children:t.label},t.value))})]}),e.jsx(l,{label:"Senha",type:"password",fullWidth:!0,required:!0,inputProps:{minLength:8},placeholder:"Mínimo 8 caracteres",value:d,onChange:t=>k(t.target.value),sx:{mb:1.5}}),e.jsx(l,{label:"Confirmar senha",type:"password",fullWidth:!0,required:!0,inputProps:{minLength:8},value:S,onChange:t=>D(t.target.value),sx:{mb:1.5}}),c&&e.jsx(r,{color:"error",sx:{mb:1.5,fontSize:14},children:c}),e.jsx(H,{type:"submit",variant:"contained",fullWidth:!0,disabled:C,sx:{py:.75},children:C?"Salvando...":"Concluir cadastro"})]}),e.jsx(r,{sx:{mt:2,fontSize:14},children:e.jsx(x,{to:"/login",style:{color:"inherit"},children:"Já tem conta? Entrar"})})]})}):e.jsxs(u,{sx:{maxWidth:400,mx:"auto",p:2,textAlign:"center"},children:[e.jsx(r,{variant:"h5",sx:{mb:.5},children:"Link inválido"}),e.jsx(r,{children:"Use o link recebido por e-mail para acessar o formulário de cadastro."}),e.jsx(r,{sx:{mt:2},children:e.jsx(x,{to:"/login",style:{color:"inherit"},children:"Ir para o login"})})]})}export{ee as RegisterProfessional};
